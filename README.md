# ⛅Morriña en Galicia o Galicia Weather  
Este proyecto es sobre el clima de Galicia y sus seis ciudades, en particular sobre tres variables: La temperatura, las precipitaciones y la humedad relativa. Realizado netamente en Python.  
## Motivo  
Estuve poco más de dos años viviendo en Galicia y siempre me dijeron que en esta zona llovía mucho y que antes inclusive más, que "el frío de galicia es diferente, se te mete a los huesos".  
Esto siempre despertó curiosidad en mi, preguntandome ¿cuántos días llovian al año?, ¿cuánto frío habrá?, ¿será que este "frío en los huesos" es por la humedad"? y muchas otras preguntas que no sabía cómo contestar.  
Por lo que decidí hacer este proyecto. Que tiene como finalidad responder varias de estas preguntas que despertaron mi curiosidad.  
## Proyecto  
Este proyecto contiene los datos de las ciudades más grandes de Galicia (Coruña, Lugo, Ourense, Vigo, Pontevedra y Santiago de Compostela) donde haré un análisis de datos desde 1 de Enero del 2023 hasta el 1 de Marzo del 2025. Para responder algunas de estas preguntas ya mencionadas, realizar otro tipo de estudias, comparaciones y predicciones.  
### Datos  
Todos los datos fueron obtenidos de [MeteoGalicia](https://www.meteogalicia.gal) y de su API [MeteoSIX](https://www.meteogalicia.gal/web/modelos-numericos/meteosix).  
Comprenden el periodo desde 1ro de Enero del 2023 hasta el 31 de Marzo del 2025. Con tres variables de interés: Precipitación, Temperatura y Humedad.
### Herramientas
La gran parte del proyecto está escrita en Python, tiene una sección en CSS para poder editar todo el segmento de Streamlit.  
Las librerías utilizadas son: Pandas, OS, Streamlit, Plotly, Seaborn, Folium, entre otras.
## Preparación
Los datos obtenidos por MeteoGalicia vienen dados en CSV, ellos tienen una interfaz gráfica para obtener estos datos desde su página, es sencilla y se pueden obtener datos hasta más de 10 años, pero sólo de 1 punto a la vez. Por otra parte los de Forecast se obtienen de la API MeteoSIX en JSON.    
### Total de datos
Por lo que contamos con 6 tablas (una para cada ciudad) de un total de 4 columnas (fecha, humedad, precipitación y temperatura) y 821 filas (una fila equivaldría a un día). Siendo un total de casi 5000 datos.  
Mientras que para el forecast sería 6 tablas temporales (una por cada ciudad), y 5 columnas (aquí se añade sky_state o estado de cielo a las columnas). Siendo un total de 144 datos, si tomamos en cuenta todas las tablas.
## Proceso
El proceso fue sencillo, ya que los datos son dados en CSV y con él se realizó un pequeño script (cleanWeatherData.py) para pivotar la tabla de forma que se pudiese concatenar dichas tablas en una sola y generar una columna "ciudad" que contenga la ciudad de la tabla. Para el dataframe de predicción también se generó un script (cleanForecastInfo.py) pero este convirtiendo el JSON en un DataFrame, el cual también hace petición de estado del cielo y se encuentra en horas, por lo que habrá 24 datos para ver la evolución horaria del día a predecir. Ambas dos se encuentran en la carpeta data/cleaning  
## Análisis
El análisis se dividió por variable, por lo que tendremos tres secciones diferentes (Precipitación, Temperatura y Humedad) utilizando la fecha para cada una de ellas.  
### Precipitación
La primera sección de precipitación se buscó valores a nivel de Galicia, es decir, estáticos. Primero el valor de precipitación medio por ciudad, para poder obtener la ciudad con mayor y menor precipitación media. Además se realizó un recuento con los días de precipitación (precipitación != 0) para obtener la ciudad con más y con menos días de lluvia. Adicionalmente se buscó el máximo por lluvia, es decir el día que más llovió y el mes que más llovió.  
Luego un gráfico de tipo pie y algunos KPIs que si cambian dependiendo de la ciudad que se seleccione. El gráfico de pie representa los días con y sin lluvia además de su porcentaje en base al total, para saber cómo se distribuyen estos en la localización seleccionada. Mientras que los KPIs presenta el total de días, los días con lluvia, los días sin lluvia, la cantidad de lluvia total, el promedio y el máximo. Por último tenemos todos los meses totales dentro del rango a evaluar con el mes más lluvioso y el menos lluvioso.  
Luego se agrega la precipitación mensual en la localización. Esta con una gráfica de columnas presenta a lo largo del tiempo la precipitación mensual y más abajo una parecida pero con precipitación diaria, esto ya que son gráficas de Plotly se colocan a diario para poder visualizar con zoom si es necesario. Lo más cotidiano es pensar que estas gráficas deberían ser de líneas, ya que al ser una medida vista a lo largo del tiempo es lo que mejor la describiría, se optó por una gráfica de columnas porque permiten visualizar la distribución de precipitación por ciudad cuando se habla de Galicia, viendo así cual es la ciudad que más aporta lluvia a la comunidad autónoma. En este caso podemos ver que es Santiago de compostela, mientras que su contraparte sería Ourense la ciudad con menos precipitación.  
### Temperatura  
En esta primera sección también se presentan valores a nivel de Galicia, es decir, estáticos. Donde se ven dos filas, la primera fila representa lo más frío, la ciudad más fría, el pico más frío en una ciudad, el día más frío y el mes más frío. Mientras que la segunda fila la otra parte, la ciudad más calurosa, la ciudad con pico ma´s caluroso, el día más caluroso y el mes más cálido. Los valores más frío por fecha son en invierno, porque es una obviedad ya que la temperatura se comporta con estacionalidad, mientras que el sitio más frío es Lugo, tanto de forma media como el pico, esto debido a que es un sitio montañoso lejos de la costa, lo que lleva a valores extremos. Para los valores más calurosos se dan en agosto, mes por excelencia de verano (estacionalidad). Mientras que la ciudad más calurosa media es Vigo, se dice que Vigo tiene un microclima, al estar en la costa apoya a que no haya temperaturas extremas, además tiene una cordillera montañosa que evita que muchas nubes pasen a la ciudad, por lo que mantiene un buen clima mucho tiempo, esto se puede observar ya que su media (16°C) está muy cerca de la mitad entre los valores más fríos (0°C) y más calurosos (31°C) de la zona. Por otra parte Ourense posee el pico más caluroso, esto debido a que está lejos del mar, apoyando así valores mucho más al extremo, en este caso hacia el calor, ya que la topografía de Ourense es un valle profundo entre montañas, donde el calor se percibe más y las masas de aire se quedan encapsuladas.  
Después vemos una gráfica de barras que categoriza los valores de temperatura y la temperatura máxima, promedio y mínima. En esta como es de esperarse en una zona de mayoría costa tiene la gran parte de los días en temperatura templado (10-20°C), esto irá variando en porcentaje pero siempre será mayor la cantidad de días templados con respecto al resto, obviamente estas dos menores aumentarán para las ciudades más lejanas de la costa (Ourense y Lugo).  
En la parte de las gráficas tenemos la evolución de temperatura mensual por ciudad a lo largo del tiempo y también diaria, la otra gráfica es un Boxplot que presenta la ciudad y su distribución por mes, esta permite ver como es el cambio estacional. Dentro de lo más destacable en esta sección es que para los valores de temperatura mensual Ourense es el máximo de temperatura para días de verano, pero es la segunda más fría para los días de invierno, esto refuerza lo antes mencionado de sus valores extremos. Mientras que las otras ciudades costeras se suelen quedar a mitd de camino, en donde vigo suele estar por encima de todas en mayor parte del año, ya que posee un microclima favorable.  
### Humedad  
La primera sección de Humedad relativa también presenta valores a nivel de Galicia. Donde la primera fila es es para los valores más húmedos y la seguna para los menos húmedos o secos. El mes y día más humedo suele verse en Noviembre, cuando comienza la transición de otoño a invierno, mientras que para finales de abril y en abril suele verse el momento menos húmedo, justo en el cambio de invierno a primavera. Esto se explica también con estacionalidad, ya que en una comienzan las lluvias fuertes luego de meses en los que había estado bastante seco y la otra comienza una temporada seca luego de mucha lluvia en invierno y antes de la lluvia de primavera. Por la parte de las ciudades, Coruña es la más humeda, esto se debe a que al ser una zona muy costera que queda expuesta a los vientos y lluvias del mar, mientras que la ciudad menos húmeda es Ourense, esto dado por lo antes mencionado, en las épocas de calor al ser un valle, suele tener muy poca humedad, en comparación al resto de ciudades gallegas.  
La siguiente sección presenta un gráfico de barras categórico donde se puede ver el recuento de días por tres categorías (seco, moderado y húmedo), además de un máximo de humedad, la humedad promedio y la humedad mínima. Estos valores varían dependiendo de la ciudad seleccionada, pero lo cierto es que en la gran mayoría de los días el valor suele ser húmedo, esto por la zona donde estamos, al final mucha densidad de bosque, cercana al mar (hasta para ciudades como Ourense) y con mucha precipitación en general.  
En estas tenemos cuatro gráficas, dos de ellas son similares con un cambio de granularidad, de día a mes, donde podemos ver el valor medio de humedad a lo largo del tiempo. Aquí podemos observar la cudad más humeda y menos húmeda con notoriedad, que son Coruña y Ourense, Vigo en ocasiones puede llegar a ser menos húmeda y Lugo puede llegar a ser más húmeda, pero las otras dos mencionadas antes son las que suelen prevalecer.  
La gráfica que continúa es la de distribución suavizada. Esta lo que presenta es como se distribuyen las ciudades en base a su humedad y la cantidad de días que tienen de esta. Por así decirlo muestra un histograma suavizado para poder visualizar las diferentes ciudades una encima de la otra. Lo más llamativo siguen siendo Ourense y Coruña, ambas dos presentan una clara distribución bimodal, donde una parte se encuentra a los 80% de humedad y la otra varía, para Ourense baja a 60% posiblemente en días veraniegos, mientras que para Coruña sube hasta 95% y es la que más predomina en su distribución.  
Por último tenemos un tipo de Headmap, este presenta los valores mensuales a color a lo largo del tiempo para cada ciudad. Es muy gratificante obsercar como los valores más blancos se encuentran en Verano y Primavera (Mayo hasta Agosto) y los más azules se encuentran hacia Otoño e Invierno. Lo más destacable de este gráfico es Coruña, que no respeta esta estacionalidad, teniendo mucha humedad inclusive en valores de verano, lo que resulta especialmente anómalo sobretodo en el periodo del 2023. Por otra parte vemos a Vigo que suele ser el más estable a lo largo de todo el año, bastante peculiar su microclima.  
## Compartir  
Las conclusiones de estos datos son más observativas, mucha de la información y explicación dentro del análisis fue en base a otros estudios hechos. Ya que para la explicación entran conceptos de estacionalidad, geográficos y topográficos, que a simple vista al ver estas métricas no son sencillas de concluir. Al final esta descripción es netamente educativa.  
### Conclusiones
Conclusiones luego de dos años vivendo en Galicia:  
- Toda Galicia sin excepción es muy húmeda, casi en todo el año, podría salir Ourense en días sueltos, pero no es normal.
- La mejor ciudad para vivir en base al clima es Vigo (microclima favorable) y la peor es Santiago de Compostela (demasiada lluvia y de las más frías).
- Las ciudades en base a precipitación se ordenan de la siguiente forma: Santiago de Compostela > Coruña > Lugo > Pontevedra > Vigo > Ourense.
- Las ciudades en base a temperatura se ordenan de la siguiente forma (Tprom): Vigo > Pontevedra > Coruña > Ourense > Santiago de Compostela > Lugo.
- Las ciudades en base a humedad se ordenan de la siguiente forma: Coruña > Lugo > Santiago de Compostela > Pontevedra > Vigo > Ourense.
### Recomendaciones
- Generar una medida llamada "bochorno", en Galicia se utiliza la palabra bochorno para referirse a un calor húmedo, suele producirse cuando la humedad es alta y la temperatura también, pasa normalmente con cielos nublados o luego de lluvia.
- Comparar alguna de las ciudades gallegas con otra ciudad de España (Madrid y Barcelona), para poder observar el aporte de lluvias del atlántico y la diferencia de vegetación.
- Generar conclusiones a partir de mayor cantidad de tiempo, quizás diez años o más.
- Generar un modelo capaz de predecir el clima.
- Generar un script de Selenium para realizar las peticiones a la página de MeteoGalicia de forma automática.
